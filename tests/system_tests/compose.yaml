services:
  numtracker:
    image: ghcr.io/diamondlightsource/numtracker:1.0.1
    ports:
      - "8406:8000"
    post_start:
      - command: /app/numtracker client configure adsim --directory '/tmp/' --scan '{instrument}-{scan_number}' --detector '{instrument}-{scan_number}-{detector}' --number 43

  rabbitmq:
    image: docker.io/rabbitmq:4.0-management
    ports:
      - "5672:5672"
      - "15672:15672"
      - "61613:61613"
    volumes:
      - type: bind
        source: ./services/rabbitmq_plugins
        target: /etc/rabbitmq/enabled_plugins
